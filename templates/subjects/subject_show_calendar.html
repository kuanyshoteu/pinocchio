{% load ttags %}
<span style="display: none;" class="instance_id" id="{{ instance.id }}"></span>
<span style="display: none;" class="change_schedule_url" url="{{ instance.change_schedule_url }}"></span>
<div class="ui segment" style="margin-bottom: 0">
    <i class="icon table"></i> Расписание
</div>

<div id="calendar" length='7'>           
    <div id="week">   
        <div class="week" id="0">
            <div class="daysmall daysmall_time" style="padding-top: 17px;">
            </div>
            {% for day in days %}
            {% if day.number != 7 %} 
            <div class="daysmall">
                <div class="day-name">
                    {{ day.title }}
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="ui divider" style="margin: 0; padding: 2px;background-color:#4A4A4A "></div>
        {% for timep in time_periods %}
        <div class="week" id="{{ forloop.counter }}">
            <div class="daysmall daysmall_time" style="padding-top: 17px;">
                {{ timep.start }}-{{ timep.end }}
            </div>
            {% for cell in timep.time_cell.all %}  
            {% if cell.day.number != 7 %} 
            <div class="daysmall other" style="padding: 0;">                                     
                <div {% if page == 'subject_update' %} style=""{% endif %}>
                    {% for lecture in cell|cell_subject_lectures:instance %}
                        {% if teacher or lecture.squad in profile.squads.all %}
                        <div class="ui segment in_schedule" style="padding: 0px;margin-bottom: 3px; margin-top: 0px;background-color:#5181b8;">
                            {{ lecture.squad.title }}
                            {% if instance.cabinet %}
                            <br>
                            <span style="color: rgba(255, 255, 255, .5);font-size: 11px">{{ instance.cabinet }}</span>
                            {% endif %}
                        </div>
                        {% endif %}
                    {% endfor %}
                    {% if page == 'subject_update' %}
                    <div id="{{ cell.id }}" ondrop="drop(event)" ondragover="allowDrop(event)" style="
                        {% if cell|cell_subject_lectures:instance|length == 0 %}
                            min-height: 79px;
                            line-height: 79px;
                        {% else %} 
                            min-height: 20px;
                        {% endif %}border: 1px solid grey;">+</div>
                    {% endif %}
                </div>
            </div>
            {% endif %}
            {% endfor %}
        </div>
        <div class="ui divider" style="margin: 0; padding: 2px;background-color:#4A4A4A "></div>
        {% endfor %}
    </div>
</div>   
