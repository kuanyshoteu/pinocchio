{% load ttttags %}
{% load ttags %}
<div style="background-color: #4A4A4A;">
	<div class="ui grid" style="margin: 0;padding: 0 25px 0 0;">
		<div style="width: 25%;padding: 0;">
			<div style="text-align: left;color: white;height: 30px;line-height: 30px;">
		    </div>
			{% for student in att_squad.students.all %}
				<div class="student_name" style="{% if forloop.counter|is_odd %}background-color: #545454{% endif %}">
			        <a href="{{student.get_absolute_url}}" style="color: #fff;">{{ student.first_name }}</a>
			    </div>
			    <div class="ui divider grey_divider"></div>
			{% endfor %}
		</div>
		<div style="width: 75%;padding: 0;overflow: hidden">
			<div id="btn-prev" class="btn-prev" onclick="moverLeft()">&#60;</div>
			{% if att_squad.students.all|length == 0 %}
				<div class="highlight_black">
					Еще нет студентов в этой группе,<br> добавить студентов можно в <a class="ui button mini green" href="{{att_squad.get_update_url}}">Настройках группы</a> или в <a class="ui button mini green" href="/schools/crm/">CRM</a>
				</div>			
			{% elif att_subject.number_of_materials == 0 %}
				<div class="highlight_black">
					Количество уроков курса равна 0, оценки можно ставить только за урок
					<br>
					Изменить количество уроков можно в <a class="ui button mini green" href="{{att_subject.get_update_url}}">Настройках курса {{att_subject.title}}</a>
				</div>			
			{% elif att_subject|get_current_attendance:att_squad == 'No_schedule' %}
				<div class="highlight_black">
					Не настроено расписание, можетe настроить в <a class="ui button mini green" href="{{att_squad.get_update_url}}">Настройках группы {{att_squad.title}}</a>
				</div>
			{% else %}
			<div id="slider" class="slider" first_set="no" last_set="no" index="0">
				<div id="prev_atts" style="width: max-content;display: flex;"></div>
				{% for date in att_subject|get_current_attendance:att_squad %}
					<section class="slider__section">
						<div class="attendance_date{%if forloop.counter == 4%} last_att{%endif%} att{{forloop.counter}}" number="{{forloop.counter}}" id="{{date.0.0.subject_materials.id}}">
                            {{ date.1 }}
						</div>
						{% if date.2 == 'now' %}
							{% for attendance in date.0 %}
								<div class="attendance_block" style="{% if forloop.counter|is_odd %}background-color: #545454{%endif%}">
								    <div id="grades{{ attendance.id }}" style="{% if attendance.present != 'present' %}display: none;{% endif %};height: 100%;">
								        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 5 %}green{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="5">5</a>
								        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 4 %}green{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="4">4</a>
								        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 3 %}green{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="3">3</a>
								        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 2 %}green{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="2">2</a>
								    </div>
								    <div id="attendance{{ attendance.id }}" style="{% if attendance.present == 'present' %}display: none;{% endif %}">
								        <a url="{{ attendance.present_url }}" class="ui button mini full-w blue att_present" id="{{attendance.id}}">На уроке</a>
								    </div>
								</div>
								<div class="ui divider grey_divider"></div>
							{% endfor %}
						{% else %}
							{% for attendance in date.0 %}
								<div class="attendance_block" style="{% if forloop.counter|is_odd %}background-color: #545454{%endif%}">
								        {% if attendance.grade > 0 %}
								        <div class="attendace_grade">
								            {{attendance.grade}}
								        </div>
								        {% endif %}
								</div>
								<div class="ui divider grey_divider"></div>
							{% endfor %}
						{% endif %}
					</section>
				{% endfor %}
				<div id="next_atts" style="width: max-content;display: flex;"></div>
			</div>
			{% endif %}
			<div id="btn-next" class="btn-next" onclick="moverRight()">&#62;</div>
		</div>
	</div>
</div>
<span class="more_attendance_url" url="{{ hisprofile.more_attendance }}" subject_id="{{att_subject.id}}" squad_id="{{att_squad.id}}" ></span>
