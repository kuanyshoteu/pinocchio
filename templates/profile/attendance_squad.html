{% load ttttags %}
{% load ttags %}
<div style="background-color: #4A4A4A;">
	<div class="ui grid" style="margin: 0;padding: 0 25px 0 0;">
		<div style="width: 25%;padding: 0;">
			<div style="text-align: left;color: white;height: 30px;line-height: 30px;">
		    </div>
			{% for student in att_squad.students.all %}
				<div class="student_name" style="{% if forloop.counter|is_odd %}background-color: #545454{% endif %}">
			        <a href="{{student.get_absolute_url}}" style="color: #fff;">{{ student.first_name }}</a>
			    </div>
			{% endfor %}
		</div>
		<div style="width: 75%;padding: 0;overflow: hidden">
			<div id="btn-prev" class="btn-prev" onclick="moverLeft()">&#60;</div>
			{% if att_squad.students.all|length == 0 %}
				<div class="highlight_black">
					Еще нет студентов в этой группе,<br> добавить студентов можно в <a class="ui button mini green" href="{{att_squad.get_update_url}}">Настройках группы</a> или в <a class="ui button mini green" href="/schools/crm/">CRM</a>
				</div>			
			{% elif att_subject.number_of_materials == 0 %}
				<div class="highlight_black">
					Количество уроков курса равна 0, оценки можно ставить только за урок
					<br>
					Изменить количество уроков можно в <a class="ui button mini green" href="{{att_subject.get_update_url}}">Настройках курса {{att_subject.title}}</a>
				</div>			
			{% elif att_subject|get_current_attendance:att_squad == 'No_schedule' %}
				<div class="highlight_black">
					Не настроено расписание, можетe настроить в <a class="ui button mini green" href="{{att_squad.get_update_url}}">Настройках группы {{att_squad.title}}</a>
				</div>
			{% else %}
			<div id="slider" class="slider" first_set="no" last_set="no" index="0">
				<div id="prev_atts" style="width: max-content;display: flex;"></div>
				{% for date in att_subject|get_current_attendance:att_squad %}
					<section class="slider__section">
						<div class="attendance_date{%if forloop.counter == 4%} last_att{%endif%} att{{forloop.counter}}" number="{{forloop.counter}}" id="{{date.0.0.subject_materials.id}}">
                            {{ date.1 }}
						</div>
						{% for attendance in date.0 %}
							<div class="attendance_block" style="{% if forloop.counter|is_odd %}background-color: #545454{%endif%}">
								{% if date.2 == 'now' %}
							    <div id="grades{{ attendance.id }}" style="{% if attendance.present != 'present' %}display: none;{% endif %};">
							        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 5 %}blue{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="5">5</a>
							        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 4 %}blue{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="4">4</a>
							        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 3 %}blue{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="3">3</a>
							        <a class="ui button mini grade{{attendance.id}} save_grade {% if attendance.grade == 2 %}blue{% endif %}" url={{attendance.change_url}} id="{{attendance.id}}" grade="2">2</a>
							    </div>
							    <div id="attendance{{ attendance.id }}" style="{% if attendance.present != '' %}display: none;{% endif %}">
							        <a status="present" class="ui button mini full-w blue att_present" id="{{attendance.id}}">На уроке</a>
							        <div style="display: flex;">
								        <a status="warned" class="ui button mini orange att_present mt5 mr5" id="{{attendance.id}}" style="padding: 5px !important;"><i class="icon clock textw mr0"></i></a>
								        <a status="absent" class="ui button mini red att_present mt5" id="{{attendance.id}}" style="padding: 5px !important;"><i class="icon close textw mr0"></i></a>
								    </div>
							    </div>
							    {%endif%}
								<div class="ui segment attendace_grade attresult{{ attendance.id }}" style="{%if date.2 == 'now' and attendance.present == 'present' or date.2 == 'now' and attendance.present == '' %}display: none;{%endif%}
						        background-color: 
						        {%if attendance.present == 'present'%}
						        #21BA45
						        {%elif attendance.present == 'warned'%}
						        #f2711c
						        {%elif attendance.present == 'noteacher'%}
						        #e03997
						        {%else%}
						        #DB2828
						        {%endif%}
						        ">
							        {% if attendance.grade > 0 %}
							            {{attendance.grade}}
							        {%else%}
							        <i class="icon clock text10 textw mr0" id="clock{{ attendance.id }}" style="{%if attendance.present == 'absent' or attendance.present == ''%}display: none;{%endif%}"></i>
							        <i class="icon close text10 textw mr0" id="close{{ attendance.id }}" style="{%if attendance.present == 'warned' or attendance.present == 'noteacher'%}display: none;{%endif%}"></i>
							        {%endif%}
						        </div>
						        {%if date.2 == 'now'%}
						        <a status="cancel" class="ui button mini att_present attcancel{{attendance.id}}" id="{{attendance.id}}" style="padding: 3px 10px !important;margin: 5px auto 0 auto;{%if attendance.present == ''%}display: none;{%endif%}">Отмена</a>
						        {%endif%}
							</div>
						{% endfor %}
					</section>
				{% endfor %}
				<div id="next_atts" style="width: max-content;display: flex;"></div>
			</div>
			{% endif %}
			<div id="btn-next" class="btn-next" onclick="moverRight()">&#62;</div>
		</div>
	</div>
</div>
<span class="more_attendance_url" url="{{ hisprofile.more_attendance }}" subject_id="{{att_subject.id}}" squad_id="{{att_squad.id}}" ></span>
